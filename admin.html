<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin – Create Card</title>
  <link href="https://cdn.jsdelivr.net/npm/quill/dist/quill.snow.css" rel="stylesheet">
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 1rem; }
    form > div { margin-bottom: 1rem; }
    label { display: block; margin-bottom: .25rem; font-weight: bold; }
    input[type="text"], select { width: 100%; padding: .5rem; }
    #editor { height: 200px; background: #fff; }
    button { padding: .75rem 1.5rem; }
  </style>
</head>
<body>
  <h1>Create New Card</h1>
  <form id="cardForm">
    <div>
      <label>Title</label>
      <input name="title" type="text" required />
    </div>
    <div>
      <label>Category</label>
      <input name="category" type="text" required />
    </div>
    <div>
      <label>Body</label>
      <div id="editor"></div>
    </div>
    <div>
      <label>Video URL (optional)</label>
      <input name="video_url" type="text" placeholder="https://…mp4" />
    </div>
    <button type="submit">Save</button>
  </form>

  <script src="https://cdn.jsdelivr.net/npm/quill/dist/quill.min.js"></script>
  <script>
    // init Quill
    const quill = new Quill('#editor', {
      theme: 'snow',
      modules: { toolbar: [['bold','italic'], [{ 'list': 'ordered'},{ 'list': 'bullet' }]] }
    });

    // handle submit
    document.getElementById('cardForm').addEventListener('submit', async e => {
      e.preventDefault();
      const form = e.target;
      const payload = {
        title: form.title.value,
        category: form.category.value,
        body: quill.root.innerHTML,
        video_url: form.video_url.value.trim() || null
      };
      const res = await fetch('/api/cards', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
      if (res.ok) {
        alert('Card created!');
        form.reset();
        quill.setContents([]);
      } else {
        alert(`Error: ${await res.text()}`);
      }
    });
  </script>
</body>
</html>
